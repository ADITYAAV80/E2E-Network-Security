[2025-03-31 18:15:53,808: ERROR: utils : Form data requires "python-multipart" to be installed. 
You can install "python-multipart" with: 

pip install python-multipart
]
[2025-03-31 18:16:20,737: ERROR: utils : Form data requires "python-multipart" to be installed. 
You can install "python-multipart" with: 

pip install python-multipart
]
[2025-03-31 18:17:12,419: INFO: training_pipeline : Starting Training Pipeline]
[2025-03-31 18:17:12,419: INFO: training_pipeline : >>>>>Stage Data Ingestion Stage started <<<<<<]
[2025-03-31 18:17:12,421: INFO: common : Yaml File: config/config.yaml loaded successfully]
[2025-03-31 18:17:12,424: INFO: common : Yaml File: params.yaml loaded successfully]
[2025-03-31 18:17:12,427: INFO: common : Yaml File: schema.yaml loaded successfully]
[2025-03-31 18:17:12,427: INFO: common : created directory at: artifacts]
[2025-03-31 18:17:12,427: INFO: common : created directory at: artifacts/data_ingestion]
[2025-03-31 18:17:12,494: INFO: data_ingestion : Fetching data from MongoDB collection: NetworkData]
[2025-03-31 18:17:15,031: INFO: data_ingestion : Data successfully downloaded and saved to artifacts/data_ingestion/datafromDB.csv]
[2025-03-31 18:17:15,049: INFO: training_pipeline : >>>>Stage Data Ingestion Stage completed <<<<<<

x==========x]
[2025-03-31 18:17:15,049: INFO: training_pipeline : >>>>>Stage Data Validation Stage started <<<<<<]
[2025-03-31 18:17:15,051: INFO: common : Yaml File: config/config.yaml loaded successfully]
[2025-03-31 18:17:15,053: INFO: common : Yaml File: params.yaml loaded successfully]
[2025-03-31 18:17:15,056: INFO: common : Yaml File: schema.yaml loaded successfully]
[2025-03-31 18:17:15,056: INFO: common : created directory at: artifacts]
[2025-03-31 18:17:15,056: INFO: common : created directory at: artifacts/data_validation]
[2025-03-31 18:17:15,081: INFO: training_pipeline : >>>>Stage Data Validation Stage completed <<<<<<

x==========x]
[2025-03-31 18:17:15,081: INFO: training_pipeline : >>>>>Stage Data Transformation Stage started <<<<<<]
[2025-03-31 18:17:15,083: INFO: common : Yaml File: config/config.yaml loaded successfully]
[2025-03-31 18:17:15,085: INFO: common : Yaml File: params.yaml loaded successfully]
[2025-03-31 18:17:15,088: INFO: common : Yaml File: schema.yaml loaded successfully]
[2025-03-31 18:17:15,088: INFO: common : created directory at: artifacts]
[2025-03-31 18:17:15,088: INFO: common : created directory at: artifacts/data_transformation]
[2025-03-31 18:17:15,288: INFO: data_transformation : Splitted data into training and test sets]
[2025-03-31 18:17:15,288: INFO: data_transformation : (8000, 49)]
[2025-03-31 18:17:15,288: INFO: data_transformation : (2000, 49)]
[2025-03-31 18:17:15,290: INFO: training_pipeline : >>>>Stage Data Transformation Stage completed <<<<<<

x==========x]
[2025-03-31 18:17:15,290: INFO: training_pipeline : >>>>>Stage Model Evaluation Stage started <<<<<<]
[2025-03-31 18:17:15,291: INFO: common : Yaml File: config/config.yaml loaded successfully]
[2025-03-31 18:17:15,294: INFO: common : Yaml File: params.yaml loaded successfully]
[2025-03-31 18:17:15,296: INFO: common : Yaml File: schema.yaml loaded successfully]
[2025-03-31 18:17:15,297: INFO: common : created directory at: artifacts]
[2025-03-31 18:17:15,297: INFO: common : created directory at: artifacts/model_evaluation]
[2025-03-31 18:17:32,932: ERROR: training_pipeline : Non-zero exit code: -2
Command: ['bash', '-c', 'source /tmp/tmp4f85i9xy/envs/virtualenv_envs/mlflow-e83e3d5a84004286d00d34d3eb4a7e3d743ccf22/bin/activate && python /home/aditya/miniconda3/envs/network_security/lib/python3.12/site-packages/mlflow/pyfunc/_mlflow_pyfunc_backend_predict.py --model-uri file:///tmp/tmp8fb59r7g/model --content-type json --input-path /tmp/tmp930vr14l/input.json']

An exception occurred while running model prediction within a uv environment. You can find the error message from the prediction subprocess by scrolling above.]
Traceback (most recent call last):
  File "/home/aditya/network_security/src/NetworkSecurity/pipeline/training_pipeline.py", line 77, in start_model_evaluation
    mep.initiate_model_evaluate()
  File "/home/aditya/network_security/src/NetworkSecurity/pipeline/model_evaluate.py", line 18, in initiate_model_evaluate
    raise e
  File "/home/aditya/network_security/src/NetworkSecurity/pipeline/model_evaluate.py", line 16, in initiate_model_evaluate
    mt.evaluate()
  File "/home/aditya/network_security/src/NetworkSecurity/components/model_evaluate.py", line 49, in evaluate
    self.validate_model(model_uri, sample_input)
  File "/home/aditya/network_security/src/NetworkSecurity/components/model_evaluate.py", line 30, in validate_model
    raise e
  File "/home/aditya/network_security/src/NetworkSecurity/components/model_evaluate.py", line 22, in validate_model
    mlflow.models.predict(
  File "/home/aditya/miniconda3/envs/network_security/lib/python3.12/site-packages/mlflow/models/python_api.py", line 265, in predict
    _predict(input_path)
  File "/home/aditya/miniconda3/envs/network_security/lib/python3.12/site-packages/mlflow/models/python_api.py", line 243, in _predict
    ).predict(
      ^^^^^^^^
  File "/home/aditya/miniconda3/envs/network_security/lib/python3.12/site-packages/mlflow/pyfunc/backend.py", line 216, in predict
    raise MlflowException(
mlflow.exceptions.MlflowException: Non-zero exit code: -2
Command: ['bash', '-c', 'source /tmp/tmp4f85i9xy/envs/virtualenv_envs/mlflow-e83e3d5a84004286d00d34d3eb4a7e3d743ccf22/bin/activate && python /home/aditya/miniconda3/envs/network_security/lib/python3.12/site-packages/mlflow/pyfunc/_mlflow_pyfunc_backend_predict.py --model-uri file:///tmp/tmp8fb59r7g/model --content-type json --input-path /tmp/tmp930vr14l/input.json']

An exception occurred while running model prediction within a uv environment. You can find the error message from the prediction subprocess by scrolling above.
[2025-03-31 18:17:32,934: ERROR: main : Error occurred in python 
                    script name:
                    =====================
                    [/home/aditya/network_security/src/NetworkSecurity/pipeline/training_pipeline.py] 
                    line number [100] 
                    error message [Non-zero exit code: -2
Command: ['bash', '-c', 'source /tmp/tmp4f85i9xy/envs/virtualenv_envs/mlflow-e83e3d5a84004286d00d34d3eb4a7e3d743ccf22/bin/activate && python /home/aditya/miniconda3/envs/network_security/lib/python3.12/site-packages/mlflow/pyfunc/_mlflow_pyfunc_backend_predict.py --model-uri file:///tmp/tmp8fb59r7g/model --content-type json --input-path /tmp/tmp930vr14l/input.json']

An exception occurred while running model prediction within a uv environment. You can find the error message from the prediction subprocess by scrolling above.]
                    error type [<class 'mlflow.exceptions.MlflowException'>]
                    error value [Non-zero exit code: -2
Command: ['bash', '-c', 'source /tmp/tmp4f85i9xy/envs/virtualenv_envs/mlflow-e83e3d5a84004286d00d34d3eb4a7e3d743ccf22/bin/activate && python /home/aditya/miniconda3/envs/network_security/lib/python3.12/site-packages/mlflow/pyfunc/_mlflow_pyfunc_backend_predict.py --model-uri file:///tmp/tmp8fb59r7g/model --content-type json --input-path /tmp/tmp930vr14l/input.json']

An exception occurred while running model prediction within a uv environment. You can find the error message from the prediction subprocess by scrolling above.]
                    ]
Traceback (most recent call last):
  File "/home/aditya/network_security/src/NetworkSecurity/pipeline/training_pipeline.py", line 100, in run_pipeline
    self.start_model_evaluation()
  File "/home/aditya/network_security/src/NetworkSecurity/pipeline/training_pipeline.py", line 81, in start_model_evaluation
    raise e
  File "/home/aditya/network_security/src/NetworkSecurity/pipeline/training_pipeline.py", line 77, in start_model_evaluation
    mep.initiate_model_evaluate()
  File "/home/aditya/network_security/src/NetworkSecurity/pipeline/model_evaluate.py", line 18, in initiate_model_evaluate
    raise e
  File "/home/aditya/network_security/src/NetworkSecurity/pipeline/model_evaluate.py", line 16, in initiate_model_evaluate
    mt.evaluate()
  File "/home/aditya/network_security/src/NetworkSecurity/components/model_evaluate.py", line 49, in evaluate
    self.validate_model(model_uri, sample_input)
  File "/home/aditya/network_security/src/NetworkSecurity/components/model_evaluate.py", line 30, in validate_model
    raise e
  File "/home/aditya/network_security/src/NetworkSecurity/components/model_evaluate.py", line 22, in validate_model
    mlflow.models.predict(
  File "/home/aditya/miniconda3/envs/network_security/lib/python3.12/site-packages/mlflow/models/python_api.py", line 265, in predict
    _predict(input_path)
  File "/home/aditya/miniconda3/envs/network_security/lib/python3.12/site-packages/mlflow/models/python_api.py", line 243, in _predict
    ).predict(
      ^^^^^^^^
  File "/home/aditya/miniconda3/envs/network_security/lib/python3.12/site-packages/mlflow/pyfunc/backend.py", line 216, in predict
    raise MlflowException(
mlflow.exceptions.MlflowException: Non-zero exit code: -2
Command: ['bash', '-c', 'source /tmp/tmp4f85i9xy/envs/virtualenv_envs/mlflow-e83e3d5a84004286d00d34d3eb4a7e3d743ccf22/bin/activate && python /home/aditya/miniconda3/envs/network_security/lib/python3.12/site-packages/mlflow/pyfunc/_mlflow_pyfunc_backend_predict.py --model-uri file:///tmp/tmp8fb59r7g/model --content-type json --input-path /tmp/tmp930vr14l/input.json']

An exception occurred while running model prediction within a uv environment. You can find the error message from the prediction subprocess by scrolling above.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/aditya/network_security/main.py", line 49, in train_route
    train_pipeline.run_pipeline()
  File "/home/aditya/network_security/src/NetworkSecurity/pipeline/training_pipeline.py", line 107, in run_pipeline
    raise NetworkSecurityException(e, sys)
src.NetworkSecurity.exception.exception.NetworkSecurityException: Error occurred in python 
                    script name:
                    =====================
                    [/home/aditya/network_security/src/NetworkSecurity/pipeline/training_pipeline.py] 
                    line number [100] 
                    error message [Non-zero exit code: -2
Command: ['bash', '-c', 'source /tmp/tmp4f85i9xy/envs/virtualenv_envs/mlflow-e83e3d5a84004286d00d34d3eb4a7e3d743ccf22/bin/activate && python /home/aditya/miniconda3/envs/network_security/lib/python3.12/site-packages/mlflow/pyfunc/_mlflow_pyfunc_backend_predict.py --model-uri file:///tmp/tmp8fb59r7g/model --content-type json --input-path /tmp/tmp930vr14l/input.json']

An exception occurred while running model prediction within a uv environment. You can find the error message from the prediction subprocess by scrolling above.]
                    error type [<class 'mlflow.exceptions.MlflowException'>]
                    error value [Non-zero exit code: -2
Command: ['bash', '-c', 'source /tmp/tmp4f85i9xy/envs/virtualenv_envs/mlflow-e83e3d5a84004286d00d34d3eb4a7e3d743ccf22/bin/activate && python /home/aditya/miniconda3/envs/network_security/lib/python3.12/site-packages/mlflow/pyfunc/_mlflow_pyfunc_backend_predict.py --model-uri file:///tmp/tmp8fb59r7g/model --content-type json --input-path /tmp/tmp930vr14l/input.json']

An exception occurred while running model prediction within a uv environment. You can find the error message from the prediction subprocess by scrolling above.]
                    
[2025-03-31 21:16:21,197: INFO: common : Yaml File: config/config.yaml loaded successfully]
[2025-03-31 21:16:21,201: INFO: common : Yaml File: params.yaml loaded successfully]
[2025-03-31 21:16:21,207: INFO: common : Yaml File: schema.yaml loaded successfully]
[2025-03-31 21:16:21,208: INFO: common : created directory at: artifacts]
[2025-03-31 21:16:21,209: INFO: common : created directory at: artifacts/model_trainer]
[2025-03-31 21:18:52,332: INFO: common : Yaml File: config/config.yaml loaded successfully]
[2025-03-31 21:18:52,336: INFO: common : Yaml File: params.yaml loaded successfully]
[2025-03-31 21:18:52,342: INFO: common : Yaml File: schema.yaml loaded successfully]
[2025-03-31 21:18:52,344: INFO: common : created directory at: artifacts]
[2025-03-31 21:18:52,345: INFO: common : created directory at: artifacts/model_trainer]
[2025-03-31 21:19:23,770: INFO: common : Yaml File: config/config.yaml loaded successfully]
[2025-03-31 21:19:23,774: INFO: common : Yaml File: params.yaml loaded successfully]
[2025-03-31 21:19:23,781: INFO: common : Yaml File: schema.yaml loaded successfully]
[2025-03-31 21:19:23,782: INFO: common : created directory at: artifacts]
[2025-03-31 21:19:23,783: INFO: common : created directory at: artifacts/model_trainer]
[2025-03-31 21:20:40,652: INFO: common : Yaml File: config/config.yaml loaded successfully]
[2025-03-31 21:20:40,656: INFO: common : Yaml File: params.yaml loaded successfully]
[2025-03-31 21:20:40,663: INFO: common : Yaml File: schema.yaml loaded successfully]
[2025-03-31 21:20:40,664: INFO: common : created directory at: artifacts]
[2025-03-31 21:20:40,665: INFO: common : created directory at: artifacts/model_trainer]
[2025-03-31 22:02:20,725: INFO: model_train : >>>>>Stage Model Training Stage started <<<<<<]
[2025-03-31 22:02:20,728: INFO: common : Yaml File: config/config.yaml loaded successfully]
[2025-03-31 22:02:20,730: INFO: common : Yaml File: params.yaml loaded successfully]
[2025-03-31 22:02:20,735: INFO: common : Yaml File: schema.yaml loaded successfully]
[2025-03-31 22:02:20,736: INFO: common : created directory at: artifacts]
[2025-03-31 22:02:20,736: INFO: common : created directory at: artifacts/model_trainer]
[2025-03-31 22:03:44,765: INFO: model_train : >>>>Stage Model Training Stage completed <<<<<<

x==========x]
[2025-03-31 22:19:35,390: INFO: model_evaluate : >>>>>Stage Model Evaluation Stage started <<<<<<]
[2025-03-31 22:19:35,393: INFO: common : Yaml File: config/config.yaml loaded successfully]
[2025-03-31 22:19:35,395: INFO: common : Yaml File: params.yaml loaded successfully]
[2025-03-31 22:19:35,401: INFO: common : Yaml File: schema.yaml loaded successfully]
[2025-03-31 22:19:35,401: INFO: common : created directory at: artifacts]
[2025-03-31 22:19:35,401: INFO: common : created directory at: artifacts/model_evaluation]
[2025-03-31 22:19:35,874: ERROR: model_evaluate : Not a proper runs:/ URI: runs://model. Runs URIs must be of the form 'runs:/<run_id>/run-relative/path/to/artifact']
Traceback (most recent call last):
  File "/home/aditya/network_security/src/NetworkSecurity/pipeline/model_evaluate.py", line 27, in <module>
    mep.initiate_model_evaluate(mlflow_run_id)
  File "/home/aditya/network_security/src/NetworkSecurity/pipeline/model_evaluate.py", line 18, in initiate_model_evaluate
    raise e
  File "/home/aditya/network_security/src/NetworkSecurity/pipeline/model_evaluate.py", line 16, in initiate_model_evaluate
    mt.evaluate(mlflow_run_id)
  File "/home/aditya/network_security/src/NetworkSecurity/components/model_evaluate.py", line 45, in evaluate
    loaded_model = mlflow.pyfunc.load_model(model_uri)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aditya/miniconda3/envs/network_security/lib/python3.12/site-packages/mlflow/tracing/provider.py", line 422, in wrapper
    is_func_called, result = True, f(*args, **kwargs)
                                   ^^^^^^^^^^^^^^^^^^
  File "/home/aditya/miniconda3/envs/network_security/lib/python3.12/site-packages/mlflow/pyfunc/__init__.py", line 1091, in load_model
    local_path = _download_artifact_from_uri(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aditya/miniconda3/envs/network_security/lib/python3.12/site-packages/mlflow/tracking/artifact_utils.py", line 108, in _download_artifact_from_uri
    repo = get_artifact_repository(artifact_uri=root_uri)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aditya/miniconda3/envs/network_security/lib/python3.12/site-packages/mlflow/store/artifact/artifact_repository_registry.py", line 131, in get_artifact_repository
    return _artifact_repository_registry.get_artifact_repository(artifact_uri)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aditya/miniconda3/envs/network_security/lib/python3.12/site-packages/mlflow/store/artifact/artifact_repository_registry.py", line 76, in get_artifact_repository
    return repository(artifact_uri)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aditya/miniconda3/envs/network_security/lib/python3.12/site-packages/mlflow/store/artifact/runs_artifact_repo.py", line 26, in __init__
    uri = RunsArtifactRepository.get_underlying_uri(artifact_uri)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aditya/miniconda3/envs/network_security/lib/python3.12/site-packages/mlflow/store/artifact/runs_artifact_repo.py", line 37, in get_underlying_uri
    (run_id, artifact_path) = RunsArtifactRepository.parse_runs_uri(runs_uri)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aditya/miniconda3/envs/network_security/lib/python3.12/site-packages/mlflow/store/artifact/runs_artifact_repo.py", line 54, in parse_runs_uri
    raise MlflowException(
mlflow.exceptions.MlflowException: Not a proper runs:/ URI: runs://model. Runs URIs must be of the form 'runs:/<run_id>/run-relative/path/to/artifact'
[2025-03-31 22:25:53,431: INFO: model_evaluate : >>>>>Stage Model Evaluation Stage started <<<<<<]
[2025-03-31 22:25:53,435: INFO: common : Yaml File: config/config.yaml loaded successfully]
[2025-03-31 22:25:53,437: INFO: common : Yaml File: params.yaml loaded successfully]
[2025-03-31 22:25:53,442: INFO: common : Yaml File: schema.yaml loaded successfully]
[2025-03-31 22:25:53,443: INFO: common : created directory at: artifacts]
[2025-03-31 22:25:53,443: INFO: common : created directory at: artifacts/model_evaluation]
[2025-03-31 22:26:18,128: INFO: common : json file saved at: artifacts/model_evaluation/metrics.json]
[2025-03-31 22:26:18,128: INFO: model_evaluate : >>>>Stage Model Evaluation Stage completed <<<<<<

x==========x]
